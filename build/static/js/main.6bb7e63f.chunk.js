(this["webpackJsonpsongpair-frontend"]=this["webpackJsonpsongpair-frontend"]||[]).push([[0],{109:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},154:function(e,t,n){},156:function(e,t,n){},157:function(e,t,n){},158:function(e,t,n){},179:function(e,t,n){},180:function(e,t,n){},181:function(e,t,n){},182:function(e,t,n){},183:function(e,t,n){},184:function(e,t,n){},185:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),c=n(29),s=n.n(c),o=n(10),i=n(11),l=n(89),u=(n(109),n(17)),j=(n(110),n(90)),O=n(91),d=n(63),b=n(92),h=n.n(b),p=n(4),x={FORM_REQUEST:"FORM_REQUEST",FORM_ERROR:"FORM_ERROR",FORM_SUCCESS:"FORM_SUCCESS",LOGIN_REQUEST:"LOGIN_REQUEST",LOGIN_ERROR:"LOGIN_ERROR",LOGIN_SUCCESS:"LOGIN_SUCCESS",SIGNUP_REQUEST:"SIGNUP_REQUEST",SIGNUP_SUCCESS:"SIGNUP_SUCCESS",SIGNUP_ERROR:"SIGNUP_ERROR",SIGNOUT_REQUEST:"SIGNOUT_REQUEST",SIGNOUT_SUCCESS:"SIGNOUT_SUCCESS",SIGNOUT_ERROR:"SIGNOUT_ERROR",UPDATE_LOCATION_REQUEST:"UPDATE_LOCATION_REQUEST",UPDATE_LOCATION_SUCCESS:"UPDATE_LOCATION_SUCCESS",UPDATE_LOCATION_ERROR:"UPDATE_LOCATION_ERROR",UPDATE_LIKE_REQUEST:"UPDATE_LIKE_REQUEST",UPDATE_LIKE_SUCCESS:"UPDATE_LIKE_SUCCESS",UPDATE_LIKE_ERROR:"UPDATE_LIKE_ERROR"},m={isLoggingIn:!1,loginError:null,isAuthenticated:!1,isSigningUp:!1,signUpError:null,isUpdatingPosition:!1,updatingPositionError:null,isSigningOut:!1,signOutError:null,signInForm:null,signInFormLoad:null,signInFormError:null,currentUser:{name:null,token:null,avatar:null,position:{lat:null,long:null}}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x.SIGNUP_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{isSigningUp:!0,signUpError:null});case x.SIGNUP_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{isAuthenticated:!0,isSigningUp:!1,loginError:null,currentUser:{name:t.payload.name,token:t.payload.token,avatar:t.payload.avatar}});case x.SIGNUP_ERROR:return Object(p.a)(Object(p.a)({},e),{},{isSigningUp:!1,signUpError:t.payload});case x.FORM_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{signInFormLoad:!0,signInFormError:null,signUpError:null});case x.FORM_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{signInFormLoad:!1,signInForm:t.payload});case x.FORM_ERROR:return Object(p.a)(Object(p.a)({},e),{},{signInForm:null,signInFormLoad:!1,signInFormError:t.payload});case x.LOGIN_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{isLoggingIn:!0,loginError:null});case x.LOGIN_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{isAuthenticated:!0,isLoggingIn:!1,loginError:null,currentUser:{name:t.payload.name,token:t.payload.token,avatar:t.payload.avatar}});case x.LOGIN_ERROR:return Object(p.a)(Object(p.a)({},e),{},{isLoggingIn:!1,loginError:t.payload});case x.SIGNOUT_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{isSigningOut:!0,signOutError:null});case x.SIGNOUT_ERROR:return Object(p.a)(Object(p.a)({},e),{},{isSigningOut:!1,signOutError:t.payload});case x.SIGNOUT_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{isSigningOut:!1,signOutError:null,isAuthenticated:!1,currentUser:{name:null,lastname:null,email:null,token:null}});case x.UPDATE_POSITION_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{isUpdatingPosition:!0,updatingPositionError:null});case x.UPDATE_POSITION_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{isUpdatingPosition:!1,updatingPositionError:null,currentUser:{position:{lat:t.payload.lat,long:t.payload.long}}});case x.UPDATE_POSITION_ERROR:return Object(p.a)(Object(p.a)({},e),{},{isUpdatingPosition:!1,updatingPositionError:t.payload});case x.UPDATE_LIKE_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{loadingLike:!0,likeError:null});case x.UPDATE_LIKE_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{loadingLike:!1,likeError:null,like:t.payload});case x.UPDATE_LIKE_ERROR:return Object(p.a)(Object(p.a)({},e),{},{loadingLike:!1,likeError:t.payload});default:return e}},E={FETCH_NEAR_PEOPLE:"FETCH_NEAR_PEOPLE",FETCH_NEAR_PEOPLE_ERROR:"FETCH_NEAR_PEOPLE_ERROR",FETCH_NEAR_PEOPLE_SUCCESS:"FETCH_NEAR_PEOPLE_SUCCESS",GET_PROFILE_REQUEST:"GET_PROFILE_REQUEST",GET_PROFILE_SUCCESS:"GET_PROFILE_SUCCESS",GET_PROFILE_ERROR:"GET_PROFILE_ERROR",GET_CHATS_REQUEST:"GET_CHATS_REQUEST",GET_CHATS_SUCCESS:"GET_CHATS_SUCCESS",GET_CHATS_ERROR:"GET_CHATS_ERROR",OPEN_CHAT_ROOM_REQUEST:"OPEN_CHAT_ROOM_REQUEST",OPEN_CHAT_ROOM_SUCCESS:"OPEN_CHAT_ROOM_SUCCESS",OPEN_CHAT_ROOM_ERROR:"OPEN_CHAT_ROOM_ERROR"},g={nearPeopleLoading:!1,nearPeopleLoadingError:null,nearPeopleData:null,loadingProfile:!1,profileError:null,profile:null,chatsLoading:!1,chatsError:null,chats:null,openChatLoading:!1,openChatError:null,openChatData:null},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E.FETCH_NEAR_PEOPLE:return Object(p.a)(Object(p.a)({},e),{},{nearPeopleLoading:!0,nearPeopleLoadingError:null,nearPeopleData:null});case E.FETCH_NEAR_PEOPLE_ERROR:return Object(p.a)(Object(p.a)({},e),{},{nearPeopleLoading:!1,nearPeopleLoadingError:t.payload,nearPeopleData:null});case E.FETCH_NEAR_PEOPLE_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{nearPeopleLoading:!1,nearPeopleLoadingError:null,nearPeopleData:t.payload});case E.GET_PROFILE_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{loadingProfile:!0,profileError:null});case E.GET_PROFILE_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{loadingProfile:!1,profileError:null,profile:t.payload});case E.GET_PROFILE_ERROR:return Object(p.a)(Object(p.a)({},e),{},{loadingProfile:!1,profileError:t.payload});case E.GET_CHATS_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{chatsLoading:!0});case E.GET_CHATS_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{chatsLoading:!1,chats:t.payload});case E.GET_CHATS_ERROR:return Object(p.a)(Object(p.a)({},e),{},{chatsLoading:!1,chatsError:t.payload});case E.OPEN_CHAT_ROOM_REQUEST:return Object(p.a)(Object(p.a)({},e),{},{openChatLoading:!0,openChatError:null,openChatData:null});case E.OPEN_CHAT_ROOM_SUCCESS:return Object(p.a)(Object(p.a)({},e),{},{openChatLoading:!1,openChatError:null,openChatData:t.payload});case E.OPEN_CHAT_ROOM_ERROR:return Object(p.a)(Object(p.a)({},e),{},{openChatLoading:!1,openChatError:t.payload,openChatData:null});default:return e}},R=Object(u.combineReducers)({user:f,community:S}),C={key:"tfm-songpair",storage:h.a},v=Object(d.a)(C,R),N=[O.a];var y=Object(u.createStore)(v,Object(j.composeWithDevTools)(u.applyMiddleware.apply(void 0,N))),T=Object(d.b)(y),_=y,U=n(7),A=n.n(U),P=n(13),k=n(8),I=n(12),L=n(93),w=n.n(L),G=n(26),F=Object(G.a)([function(e){return e.song}],(function(e){return e})),M={FETCH_SONG_REQUEST:"FETCH_SONG_REQUEST",FETCH_SONG_ERROR:"FETCH_SONG_ERROR",FETCH_SONG_SUCCESS:"FETCH_SONG_SUCCESS",SONG_UPDATING:"RECIPE_UPDATING",SONG_UPDATING_ERROR:"RECIPE_UPDATING_ERROR",ADD_SONG_LIKE:"ADD_SONG_LIKE",REMOVE_SONG_LIKE:"REMOVE_SONG_LIKE"},D=function(e){return{type:M.FETCH_SONG_ERROR,payload:e}};var H=n(187),Q=n(188),z=n(94),B=n(189);n(144);var K=function(e){var t=e.active;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:"left-layer ".concat(t?"active":"")}),Object(a.jsx)("div",{className:"left-layer left-layer--2 ".concat(t?"active":"")}),Object(a.jsx)("div",{className:"left-layer left-layer--3 ".concat(t?"active":"")}),Object(a.jsx)("div",{className:"left-layer left-layer--4 ".concat(t?"active":"")})]})};n(145);var J=function(){var e=Object(r.useState)(!1),t=Object(k.a)(e,2),n=t[0],c=t[1],s=Object(I.g)();return Object(a.jsxs)(H.a,{fluid:!0,className:"welcome-page",children:[Object(a.jsx)(K,{active:n}),Object(a.jsxs)(Q.a,{children:[Object(a.jsxs)(z.a,{xs:8,md:4,lg:1,children:[Object(a.jsx)("div",{className:"music-icon move-left",children:Object(a.jsx)(B.a,{size:25})}),Object(a.jsx)("div",{className:"music-icon move-right",children:Object(a.jsx)(B.a,{size:25})})]}),Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("h1",{className:"text-white",children:"Songpair"})}),Object(a.jsx)(z.a,{xs:8,md:4,lg:2,className:"text-white btn btn-primary",onClick:function(){c(!0),setTimeout((function(){return s.push("/login")}),1500)},children:"Start"}),Object(a.jsx)(z.a,{xs:12,className:"text-center text-secondary",children:"find others favorite songs"}),Object(a.jsx)(z.a,{xs:12,className:"text-center text-secondary",children:"share yours"})]})]})},W=Object(i.b)((function(e){return{songState:F(e)}}),(function(e){return{fetchSong:function(){return e(function(){var e=Object(P.a)(A.a.mark((function e(t){var n,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:M.FETCH_SONG_REQUEST}),e.next=3,fetch("fetch_from_Spotify",{method:"GET",headers:{"Content-Type":"application/json"}}).catch((function(e){console.log(e),t(D(e.message))}));case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,n.ok?t((r=a.data,{type:M.FETCH_SONG_SUCCESS,payload:r})):t(D(a.error));case 8:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}())}}}))(J),Z=function(e){return e.user},q=(Object(G.a)([Z],(function(e){return e.currentUser})),Object(G.a)([Z],(function(e){return e}))),X="http://localhost:8080/",Y=X+"profile",V=X+"chats",$=function(e){return{type:x.FORM_ERROR,payload:e}},ee=function(e){return{type:x.LOGIN_ERROR,payload:e}},te=function(e){var t=e.name,n=e.token,a=e.avatar;return{type:x.LOGIN_SUCCESS,payload:{name:t,token:n,avatar:a}}},ne=function(e){return{type:x.SIGNUP_ERROR,payload:e}},ae=function(e){var t=e.name,n=e.token,a=e.avatar;return{type:x.SIGNUP_SUCCESS,payload:{name:t,token:n,avatar:a}}},re=function(e){return{type:x.SIGNOUT_REQUEST,payload:e}},ce=function(e){return{type:x.UPDATE_LOCATION_SUCCESS,payload:{point:e}}},se=function(e){return{type:x.UPDATE_LOCATION_ERROR,payload:e}},oe=function(e){return{type:x.UPDATE_LIKE_ERROR,payload:e}};function ie(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=a().user.currentUser.token)){t.next=9;break}return n({type:x.UPDATE_LOCATION_REQUEST}),t.next=5,fetch("http://localhost:8080/map/update-position",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({point:e})}).catch((function(e){return n(se(e.message))}));case 5:t.sent.ok&&n(ce(e)),t.next=10;break;case 9:n(se("Missing auth token"));case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}function le(e,t){return function(){var n=Object(P.a)(A.a.mark((function n(a,r){var c,s,o;return A.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(c=r().user.currentUser.token)){n.next=12;break}return a({type:x.UPDATE_LIKE_REQUEST}),n.next=5,fetch("http://localhost:8080/like/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)},body:JSON.stringify({song:e,receiver:t})}).catch((function(e){return a(oe(e.message))}));case 5:return s=n.sent,n.next=8,s.json().catch((function(e){return a(oe(e.message))}));case 8:o=n.sent,s.ok?a((i=o.data.data,{type:x.UPDATE_LIKE_SUCCESS,payload:i})):a(oe(o.error)),n.next=13;break;case 12:a(oe("Missing auth token"));case 13:case"end":return n.stop()}var i}),n)})));return function(e,t){return n.apply(this,arguments)}}()}var ue=n(190),je=n(205);n(147);var Oe=function(e){var t=e.active;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:"down-layer ".concat(t?"active":"")}),Object(a.jsx)("div",{className:"down-layer down-layer--2 ".concat(t?"active":"")}),Object(a.jsx)("div",{className:"down-layer down-layer--3 ".concat(t?"active":"")}),Object(a.jsx)("div",{className:"down-layer down-layer--4 ".concat(t?"active":"")})]})},de=(n(148),{HOME:"/",LOGIN:"/login",REGISTER:"/signup",DASHBOARD:"/dashboard",MAP:"/map",PROFILE:"/profile/",CHAT:"/chat/",ROOMS:"/chats"});var be=function(e){var t=e.currentUserState,n=(t=void 0===t?{}:t).isLoggingIn,c=t.loginError,s=t.isAuthenticated,o=e.login,i=Object(r.useState)(""),l=Object(k.a)(i,2),u=l[0],j=l[1],O=Object(r.useState)(""),d=Object(k.a)(O,2),b=d[0],h=d[1],p=Object(r.useState)(!1),x=Object(k.a)(p,2),m=x[0],f=x[1],E=Object(r.useState)(!1),g=Object(k.a)(E,2),S=g[0],R=g[1];return Object(r.useEffect)((function(){f(!1)}),[b,u]),s?Object(a.jsx)(I.a,{to:de.DASHBOARD}):Object(a.jsxs)(H.a,{fluid:!0,className:"fade-in login-page",children:[Object(a.jsx)(Oe,{active:S}),Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("h1",{className:"text-white",children:"Soundpair"})}),n?Object(a.jsx)(ue.a,{animation:"border",variant:"primary"}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(z.a,{xs:9,md:5,lg:3,className:"spotify-btn my-4",children:"Log in with Spotify"}),Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("p",{className:"text-center text-secondary",children:"Or use your account"})}),Object(a.jsxs)(z.a,{xs:8,md:5,lg:3,children:[Object(a.jsx)(je.a.Control,{type:"email",placeholder:"Email",className:"mb-1",onChange:function(e){return j(e.target.value)}}),Object(a.jsx)(je.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return h(e.target.value)}}),Object(a.jsx)("div",{className:"text-white btn btn-primary w-100",onClick:function(){return""===u?f("Please, insert your email"):""===b?f("Please, insert a password"):b.length<8?f("Password minimun length: 8 chars"):void o({email:u,password:b})},children:"Log in"}),m&&Object(a.jsx)(z.a,{xs:12,className:"badge badge-danger",children:m}),c&&Object(a.jsx)(z.a,{xs:12,className:"badge badge-danger",children:c})]}),Object(a.jsx)(z.a,{xs:12,children:Object(a.jsxs)("p",{className:"text-center text-secondary mt-2",children:["Don't have one? ",Object(a.jsx)("span",{className:"text-primary",role:"button",onClick:function(){R(!0),setTimeout((function(){return window.location="http://localhost:8080/signup"}),1500)},children:"Sign up"})]})})]})]})]})},he=Object(i.b)((function(e){return{currentUserState:q(e)}}),(function(e){return{login:function(t){var n=t.email,a=t.password;return e(function(e){var t=e.email,n=e.password;return function(){var e=Object(P.a)(A.a.mark((function e(a){var r,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:x.LOGIN_REQUEST}),e.next=3,fetch("http://localhost:8080/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).catch((function(e){return a(ee(e.message))}));case 3:return r=e.sent,e.next=6,r.json().catch((function(e){return a(ne(e.message))}));case 6:c=e.sent,r.ok?a(te({name:c.data.user.name,token:c.data.token,avatar:c.data.user.avatar})):a(ee(c.error));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({email:n,password:a}))}}}))(be),pe=n(95),xe=(n(152),n.p+"static/media/dummy_avatar.1b809d7e.png");var me=function(e){var t=e.currentUserState,n=(t=void 0===t?{}:t).signInForm,c=t.signInFormLoad,s=t.signInFormError,i=t.signUpError,l=t.isSigningUp,u=t.isAuthenticated,j=e.fetchFormData,O=e.signup,d=Object(I.h)(),b=Object(r.useState)(""),h=Object(k.a)(b,2),p=h[0],x=h[1],m=Object(r.useState)(""),f=Object(k.a)(m,2),E=f[0],g=f[1],S=Object(r.useState)(""),R=Object(k.a)(S,2),C=R[0],v=R[1],N=Object(r.useState)(""),y=Object(k.a)(N,2),T=y[0],_=y[1],U=Object(r.useState)(""),A=Object(k.a)(U,2),P=A[0],L=A[1],w=Object(r.useState)(!1),G=Object(k.a)(w,2),F=G[0],M=G[1];return Object(r.useEffect)((function(){var e=Object(pe.parse)(d.search,{ignoreQueryPrefix:!0}).code;j(e)}),[j,d.search]),Object(r.useEffect)((function(){n&&(x(n.display_name),g(n.email),_(n.images[0]?n.images[0].url:xe))}),[n]),Object(r.useEffect)((function(){M(!1)}),[P,C,E,p]),u?Object(a.jsx)(I.a,{to:de.DASHBOARD}):Object(a.jsx)(H.a,{fluid:!0,className:"fade-in register-page",children:Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("h1",{className:"text-white",children:"Sign up"})}),(l||c&&!n)&&Object(a.jsx)(ue.a,{animation:"border",variant:"primary"}),n&&!l&&Object(a.jsxs)(z.a,{xs:8,md:5,lg:3,className:"text-center text-white",children:[Object(a.jsx)(je.a.Control,{type:"file",id:"avatar",className:"d-none"}),Object(a.jsx)("label",{htmlFor:"avatar",children:Object(a.jsx)("img",{src:T,alt:"user avatar",className:"avatar"})}),Object(a.jsx)(je.a.Control,{type:"name",placeholder:"Your name",className:"mb-1",value:p,onChange:function(e){return x(e.target.value)}}),Object(a.jsx)(je.a.Control,{type:"email",placeholder:"Email",className:"mb-1",value:E,onChange:function(e){return g(e.target.value)}}),Object(a.jsx)(je.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return v(e.target.value)}}),Object(a.jsx)(je.a.Check,{className:"mt-3 mb-1",type:"switch",id:"location",label:"Accept geolocation use",onClick:function(){""===P?navigator.geolocation.getCurrentPosition((function(e){L({type:"Point",coordinates:[e.coords.longitude,e.coords.latitude]})}),(function(e){L("")})):L("")}}),F&&Object(a.jsx)(z.a,{xs:12,className:"badge badge-danger",children:F}),i&&Object(a.jsx)(z.a,{xs:12,className:"badge badge-danger",children:i}),Object(a.jsx)("div",{className:"text-white btn btn-primary w-100",onClick:function(){if(""===p)return M("Please, insert your name");if(""===E)return M("Please, insert your email");if(""===C)return M("Please, insert a password");if(C.length<8)return M("Password minimun length: 8 chars");if(""===P)return M("Please, accept location use");var e={name:p,email:E,password:C,avatar:T,spotifyID:n.id,token:n.tokens.access_token,refreshToken:n.tokens.refresh_token,location:P};O(e)},children:"Register"}),Object(a.jsx)(z.a,{xs:12,children:Object(a.jsxs)("p",{className:"text-center text-secondary mt-2",children:["Got an account? ",Object(a.jsx)(o.b,{to:de.LOGIN,className:"text-primary",role:"button",children:"Sign In"})]})})]}),s&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(z.a,{xs:12,className:"badge badge-danger",children:s}),Object(a.jsx)(z.a,{xs:8,md:5,lg:3,children:Object(a.jsx)(o.b,{to:de.LOGIN,className:"btn btn-primary w-100",children:"Please try again"})})]})]})})},fe=Object(i.b)((function(e){return{currentUserState:q(e)}}),(function(e){return{fetchFormData:function(t){return e(function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r,c;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:x.FORM_REQUEST}),t.next=3,fetch("".concat("http://localhost:8080/signup/spotify","?code=").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}).catch((function(e){return n($(e.message))}));case 3:return r=t.sent,t.next=6,r.json().catch((function(e){return n($(e.message))}));case 6:c=t.sent,r.ok?n((a=c.data.data,{type:x.FORM_SUCCESS,payload:a})):n($(c.error));case 8:case"end":return t.stop()}var a}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))},signup:function(t){var n=t.name,a=t.email,r=t.password,c=t.avatar,s=t.token,o=t.refreshToken,i=t.location,l=t.spotifyID;return e(function(e){var t=e.name,n=e.email,a=e.password,r=e.avatar,c=e.token,s=e.refreshToken,o=e.location,i=e.spotifyID;return function(){var e=Object(P.a)(A.a.mark((function e(l){var u,j;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l({type:x.SIGNUP_REQUEST}),e.next=3,fetch("http://localhost:8080/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:n,password:a,avatar:r,token:c,refreshToken:s,location:o,spotifyID:i})}).catch((function(e){return l(ne(e.message))}));case 3:return u=e.sent,e.next=6,u.json().catch((function(e){return l(ne(e.message))}));case 6:j=e.sent,u.ok?l(ae({name:j.data.user.name,token:j.data.token,avatar:j.data.user.avatar})):l(ne(j.error));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({name:n,email:a,password:r,avatar:c,token:s,refreshToken:o,location:i,spotifyID:l}))}}}))(me),Ee=Object(G.a)([function(e){return e.community}],(function(e){return e})),ge=function(e){return{type:E.FETCH_NEAR_PEOPLE_ERROR,payload:e}},Se=function(e){return{type:E.GET_PROFILE_SUCCESS,payload:e}},Re=function(e){return{type:E.GET_PROFILE_ERROR,payload:e}},Ce=function(e){return{type:E.GET_CHATS_ERROR,payload:e}},ve=function(e){return{type:E.OPEN_CHAT_ROOM_ERROR,payload:e}};function Ne(){return function(){var e=Object(P.a)(A.a.mark((function e(t,n){var a,r,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n().user.currentUser.token,n().user.currentUser.id,!a){e.next=13;break}return t({type:E.GET_CHATS_REQUEST}),e.next=6,fetch("".concat(V),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}}).catch((function(e){return t(Ce(e.message))}));case 6:return r=e.sent,e.next=9,r.json().catch((function(e){return t(Ce(e.message))}));case 9:c=e.sent,r.ok?t((s=c.data.data,{type:E.GET_CHATS_SUCCESS,payload:s})):t(Ce(c.error)),e.next=14;break;case 13:t(Ce("Missing auth token"));case 14:case"end":return e.stop()}var s}),e)})));return function(t,n){return e.apply(this,arguments)}}()}var ye=function(e,t){var n,a;return a={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},n=navigator.geolocation.watchPosition((function(a){var r=a.coords;(function(e,t,n,a){var r=6378.137,c=n*Math.PI/180-e*Math.PI/180,s=a*Math.PI/180-t*Math.PI/180,o=Math.sin(c/2)*Math.sin(c/2)+Math.cos(e*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2),i=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return r*i*1e3})(r.latitude,r.longitude,e.lat,e.long)>=10&&(t({lat:r.latitude,long:r.longitude}),navigator.geolocation.clearWatch(n))}),(function(e){console.warn("ERROR("+e.code+"): "+e.message)}),a)};var Te=n(197),_e=n(198),Ue=n(206),Ae=n(191);n(153);var Pe=function(e){var t=e.title,n=e.back;return Object(a.jsx)(H.a,{fluid:!0,children:Object(a.jsx)(Q.a,{children:Object(a.jsx)(z.a,{xs:12,xl:{span:4,offset:4},className:"header bg-primary",children:Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(z.a,{xs:1,children:Object(a.jsx)(o.b,{to:n,children:Object(a.jsx)(Ae.a,{size:26,color:"white",role:"button"})})}),Object(a.jsx)(z.a,{xs:10,children:Object(a.jsx)("h2",{className:"text-white",children:t})})]})})})})},ke=n(194),Ie=n(195),Le=n(196),we=n(192),Ge=n(193),Fe=n(19),Me=n.n(Fe),De=n(96),He=Me.a.icon({iconUrl:"data:image/png;base64,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",shadowUrl:De.a,iconSize:[62,62],iconAnchor:[31,52],shadowAnchor:[12,40],popupAnchor:[0,-45]});Me.a.Marker.prototype.options.icon=He;var Qe=function(e){var t=e.communityState,n=(t=void 0===t?{}:t).openChatLoading,c=(t.openChatError,t.openChatData),s=e.user,i=e.updateLike,l=e.openChatRoom,u=e.appSocket,j=e.currentUser,O=Object(I.g)(),d=s.location.coordinates[0],b=s.location.coordinates[1],h=s.name,p=s.avatar,x=s.currentSong,m=s.like,f=s.spotifyID,E=Object(r.useState)(m),g=Object(k.a)(E,2),S=g[0],R=g[1];function C(){i(x,s.spotifyID),R(!S)}function v(){return(v=Object(P.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(f);case 2:c&&(u.emit("newChat",{sender:j.name,receiver:f,room:c._id}),O.push(de.CHAT+c._id));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.jsx)(we.a,{position:[b,d],children:Object(a.jsxs)(Ge.a,{children:[Object(a.jsxs)(Q.a,{className:"mb-2 user-row",children:[Object(a.jsx)(z.a,{xs:1,children:Object(a.jsx)("img",{src:p,className:"avatar",alt:"user avatar"})}),Object(a.jsx)(z.a,{xs:8,className:"username-container",children:Object(a.jsx)(o.b,{to:de.PROFILE+f,children:h})}),Object(a.jsx)(z.a,{xs:2,children:n?Object(a.jsx)(ue.a,{size:"sm",animation:"border",variant:"white"}):Object(a.jsx)(ke.a,{size:18,className:"chat-icon",color:"white",onClick:function(){return v.apply(this,arguments)}})})]}),Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(z.a,{xs:2,children:Object(a.jsx)("img",{src:x.image[0].url,className:"album-img",alt:"artist album"})}),Object(a.jsxs)(z.a,{xs:7,className:"ml-2",children:[Object(a.jsx)("div",{className:"music-title",children:x.music}),Object(a.jsx)("div",{className:"artist-name",children:x.artist})]}),Object(a.jsx)(z.a,{xs:2,children:S?Object(a.jsx)(Ie.a,{size:20,color:"crimson",className:"like-icon bounce-effect",role:"button",onClick:C}):Object(a.jsx)(Le.a,{size:20,color:"crimson",className:"like-icon bounce-effect",role:"button",onClick:C})})]})]})})},ze=Object(i.b)((function(e){return{currentUserState:q(e),communityState:Ee(e)}}),(function(e){return{updateLike:function(t,n){return e(le(t,n))},openChatRoom:function(t){return e(function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r,c,s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=a().user.currentUser.token)){t.next=12;break}return n({type:E.OPEN_CHAT_ROOM_REQUEST}),t.next=5,fetch("".concat(V,"/room"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({sender:r,receiver:e})}).catch((function(e){return n(Ce(e.message))}));case 5:return c=t.sent,t.next=8,c.json().catch((function(e){return n(ve(e.message))}));case 8:s=t.sent,c.ok?n((o=s.data,{type:E.OPEN_CHAT_ROOM_SUCCESS,payload:o})):n(ve(s.error)),t.next=13;break;case 12:n(ve("Missing auth token"));case 13:case"end":return t.stop()}var o}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))(Qe);n(154),n(155);var Be=function(e){var t=e.currentUserState,n=(t=void 0===t?{}:t).isAuthenticated,c=t.currentUser,s=e.communityState,o=(s=void 0===s?{}:s).nearPeopleLoading,i=s.nearPeopleLoadingError,l=s.nearPeopleData,u=e.fetchNearPeople,j=e.appSocket,O=Object(r.useState)(null),d=Object(k.a)(O,2),b=d[0],h=d[1],p=Object(r.useState)(null),x=Object(k.a)(p,2),m=x[0],f=x[1],E=Object(r.useState)(!1),g=Object(k.a)(E,2),S=g[0],R=g[1];function C(e){var t=e.center,n=e.active,a=Object(Te.a)();return b&&n&&a.setView([t.lat,t.long]),Object(r.useEffect)((function(){n&&R(!1)}),[n]),null}return Object(r.useEffect)((function(){if(b){u(b);var e=ye(b,h)}else navigator.geolocation.getCurrentPosition((function(e){return h({lat:e.coords.latitude,long:e.coords.longitude})}),(function(e){return f(e)}));return R(!0),function(){navigator.geolocation.clearWatch(e)}}),[b,u]),n?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Pe,{title:"Near People",back:de.DASHBOARD}),Object(a.jsx)(H.a,{fluid:!0,className:"map-page",children:Object(a.jsx)(Q.a,{className:"map-row text-center",children:Object(a.jsx)(z.a,{xs:12,md:11,lg:11,xl:4,children:b?Object(a.jsxs)(_e.a,{className:"map-container",center:[b.lat,b.long],zoom:100,scrollWheelZoom:!1,children:[Object(a.jsx)(C,{center:b,active:S}),o?Object(a.jsx)(Q.a,{className:"d-flex align-items-center h-100",children:Object(a.jsx)(z.a,{children:Object(a.jsx)(ue.a,{animation:"grow",variant:"primary"})})}):i?Object(a.jsx)(Q.a,{className:"d-flex align-items-center h-100",children:Object(a.jsx)(z.a,{children:Object(a.jsxs)("p",{className:"h5",children:[i,", please try again."]})})}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Ue.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),l&&l.map((function(e){return Object(a.jsx)(ze,{user:e,appSocket:j,currentUser:c},e.spotifyID)}))]})]}):Object(a.jsx)(H.a,{fluid:!0,className:"map-container",children:Object(a.jsx)(Q.a,{className:"d-flex align-items-center h-100 text-white",children:Object(a.jsx)(z.a,{children:m&&Object(a.jsx)("p",{className:"h5",children:"Could not access your geolocation, please try again."})})})})})})})]}):Object(a.jsx)(I.a,{to:de.LOGIN})},Ke=Object(i.b)((function(e){return{currentUserState:q(e),communityState:Ee(e)}}),(function(e){return{fetchNearPeople:function(t){return e(function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r,c,s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:E.FETCH_NEAR_PEOPLE}),r=a().user.currentUser.token,t.next=4,fetch("http://localhost:8080/map/near-people",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({point:e})}).catch((function(e){n(ge(e.message))}));case 4:return c=t.sent,t.next=7,c.json();case 7:s=t.sent,c.ok?n((o=s.data,{type:E.FETCH_NEAR_PEOPLE_SUCCESS,payload:o})):n(ge(s.error));case 9:case"end":return t.stop()}var o}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))(Be);function Je(e){var t=Object(r.useState)(null),n=Object(k.a)(t,2),a=n[0],c=n[1];Object(r.useEffect)((function(){if(a){var t=ye(a,c);e(a)}else navigator.geolocation.getCurrentPosition((function(e){return c({lat:e.coords.latitude,long:e.coords.longitude})}));return function(){navigator.geolocation.clearWatch(t)}}),[a,e])}var We=n(199),Ze=n(200),qe=n(201);n(156);var Xe=function(e){var t=e.currentUserState,n=(t=void 0===t?{}:t).currentUser,r=t.isAuthenticated,c=e.logout;return Je(e.updateUserLocation),r?Object(a.jsxs)(H.a,{fluid:!0,className:"dashboard py-3",children:[Object(a.jsxs)(Q.a,{className:"header",children:[Object(a.jsx)(z.a,{children:Object(a.jsx)("div",{className:"logo",children:"Songpair"})}),Object(a.jsx)(z.a,{className:"text-right",children:Object(a.jsx)(We.a,{role:"button",size:25,onClick:function(){c()}})}),Object(a.jsxs)(z.a,{xs:12,className:"text-center fade-in",children:[Object(a.jsx)("img",{className:"avatar",src:n.avatar,alt:"user avatar"}),Object(a.jsx)("span",{className:"username",children:n.name})]})]}),Object(a.jsxs)(Q.a,{className:"menu",children:[Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)(o.b,{to:de.MAP,children:Object(a.jsx)(Ze.a,{color:"white",size:100})})}),Object(a.jsx)(z.a,{xs:12,className:"mt-4",children:Object(a.jsx)(o.b,{to:de.ROOMS,children:Object(a.jsx)(qe.a,{color:"white",size:100})})})]})]}):Object(a.jsx)(I.a,{to:de.LOGIN})},Ye=Object(i.b)((function(e){return{currentUserState:q(e)}}),(function(e){return{logout:function(){return e(function(){var e=Object(P.a)(A.a.mark((function e(t,n){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=n().user.currentUser.token)){e.next=9;break}return t({type:x.SIGNOUT_REQUEST}),e.next=5,fetch("http://localhost:8080/logout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}}).catch((function(e){return t(re(e.message))}));case 5:e.sent.ok&&t({type:x.SIGNOUT_SUCCESS}),e.next=10;break;case 9:t(re("Missing auth token"));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},updateUserLocation:function(t){return e(ie(t))}}}))(Xe),Ve=n(202),$e=n(203),et=n(204);n(157);var tt=function(e){var t=e.currentUserState,n=((t=void 0===t?{}:t).currentUser,t.isAuthenticated),c=e.communityState,s=(c=void 0===c?{}:c).profile,o=c.loadingProfile,i=c.profileError,l=e.updateUserLocation,u=e.getProfile,j=e.updateLike,O=e.updateProfile,d=Object(I.i)().id;function b(){return h.apply(this,arguments)}function h(){return(h=Object(P.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.currentSong.like=!s.currentSong.like,e.next=3,j(s.currentSong,d);case 3:O(d);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Je(l),Object(r.useEffect)((function(){u(d)}),[u,d]),n?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Pe,{title:"Profile",back:de.MAP}),Object(a.jsx)(H.a,{fluid:!0,children:Object(a.jsx)(Q.a,{children:Object(a.jsxs)(z.a,{xs:12,md:{span:8,offset:2},lg:{span:6,offset:3},xl:{span:4,offset:4},children:[s&&!o&&!i&&Object(a.jsxs)(Q.a,{className:"profile-page fade-in",children:[Object(a.jsxs)(z.a,{xs:12,className:"avatar",children:[Object(a.jsx)("img",{src:s.avatar,alt:"user avatar"}),Object(a.jsx)("h4",{children:s.name})]}),Object(a.jsxs)(z.a,{xs:11,children:[Object(a.jsx)(z.a,{xs:12,className:"text-center",children:"Currently playing"}),Object(a.jsx)(Q.a,{className:"playing",children:s.currentSong?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(z.a,{xs:3,children:Object(a.jsx)("img",{src:s.currentSong.image[0].url,alt:"album"})}),Object(a.jsxs)(z.a,{xs:6,xl:7,className:"music",children:[Object(a.jsx)("div",{className:"music-title",children:s.currentSong.music}),Object(a.jsx)("div",{children:s.currentSong.artist})]}),Object(a.jsxs)(z.a,{xs:3,xl:2,className:"music-actions",children:[Object(a.jsxs)("div",{children:[s.currentSong.like?Object(a.jsx)(Ie.a,{className:"bounce-effect",role:"button",color:"crimson",onClick:b}):Object(a.jsx)(Le.a,{className:"bounce-effect",role:"button",color:"crimson",onClick:b}),Object(a.jsx)("span",{children:s.currentSong.totalLikes})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)(Ve.a,{}),Object(a.jsx)("span",{children:"Add"})]})]})]}):Object(a.jsx)(z.a,{xs:12,className:"text-center",children:"No song"})})]}),Object(a.jsx)(z.a,{xs:11,children:Object(a.jsxs)(Q.a,{className:"status",children:[Object(a.jsx)(z.a,{xs:3,className:"total-likes",children:Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("h5",{children:"Total Likes"})}),Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)(Ie.a,{color:"crimson"})}),Object(a.jsx)(z.a,{xs:12,children:s.likes.total})]})}),Object(a.jsx)(z.a,{xs:8,className:"most-liked",children:Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("h5",{children:"Most Liked Song"})}),s.likes.mostLiked?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(z.a,{xs:6,children:Object(a.jsx)("img",{src:s.likes.mostLiked.image[0].url,alt:"album"})}),Object(a.jsxs)(z.a,{xs:6,className:"music",children:[Object(a.jsx)("div",{className:"music-title",children:s.likes.mostLiked.music}),Object(a.jsx)("div",{children:s.likes.mostLiked.artist}),Object(a.jsxs)("div",{children:[Object(a.jsx)(Ie.a,{color:"crimson"}),Object(a.jsx)("span",{children:s.likes.mostLiked.likesCount})]})]})]}):Object(a.jsxs)(z.a,{xs:12,className:"text-center",children:[Object(a.jsx)("div",{children:"No likes yet"}),Object(a.jsx)($e.a,{})]})]})})]})}),Object(a.jsx)(z.a,{xs:11,className:"text-white btn btn-primary w-100",children:"Message"})]}),o&&Object(a.jsxs)(Q.a,{className:"songpair-load",children:[Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("h2",{children:"Songpair"})}),Object(a.jsx)(ue.a,{animation:"border",variant:"primary"})]}),i&&Object(a.jsxs)(Q.a,{className:"songpair-load",children:[Object(a.jsx)(z.a,{xs:12,children:Object(a.jsx)("h2",{children:"User not found :("})}),Object(a.jsx)(et.a,{})]})]})})})]}):Object(a.jsx)(I.a,{to:de.LOGIN})},nt=Object(i.b)((function(e){return{currentUserState:q(e),communityState:Ee(e)}}),(function(e){return{updateUserLocation:function(t){return e(ie(t))},getProfile:function(t){return e(function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r,c,s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=a().user.currentUser.token)){t.next=12;break}return n({type:E.GET_PROFILE_REQUEST}),t.next=5,fetch("".concat(Y,"/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}}).catch((function(e){return n(Re(e.message))}));case 5:return c=t.sent,t.next=8,c.json().catch((function(e){return n(Re(e.message))}));case 8:s=t.sent,c.ok?n(Se(s.data)):n(Re(s.error)),t.next=13;break;case 12:n(Re("Missing auth token"));case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))},updateProfile:function(t){return e(function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r,c,s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=a().user.currentUser.token)){t.next=11;break}return t.next=4,fetch("".concat(Y,"/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}}).catch((function(e){return n(Re(e.message))}));case 4:return c=t.sent,t.next=7,c.json().catch((function(e){return n(Re(e.message))}));case 7:s=t.sent,c.ok?n(Se(s.data)):n(Re(s.error)),t.next=12;break;case 11:n(Re("Missing auth token"));case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))},updateLike:function(t,n){return e(le(t,n))}}}))(tt);n(158);var at=function(e){var t=e.currentUserState,n=((t=void 0===t?{}:t).currentUser,t.isAuthenticated),c=e.getChats;return Je(e.updateUserLocation),Object(r.useEffect)((function(){c()}),[c]),n?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Pe,{title:"Join Chat",back:de.DASHBOARD}),Object(a.jsxs)(H.a,{fluid:!0,className:"chat py-3",children:[Object(a.jsx)(Q.a,{className:"header",children:Object(a.jsx)(z.a,{xs:12,className:"text-center",children:Object(a.jsx)("span",{className:"username",children:"Select Chat Room"})})}),Object(a.jsxs)(Q.a,{className:"menu",children:[Object(a.jsx)(z.a,{xs:12,className:"mt-4",children:Object(a.jsx)(o.b,{to:"/chat/1",children:Object(a.jsx)(qe.a,{color:"white",size:100})})}),Object(a.jsx)(z.a,{xs:12,className:"mt-4",children:Object(a.jsx)(o.b,{to:"/chat/2",children:Object(a.jsx)(qe.a,{color:"white",size:100})})}),Object(a.jsx)(z.a,{xs:12,className:"mt-4",children:Object(a.jsx)(o.b,{to:"/chat/3",children:Object(a.jsx)(qe.a,{color:"white",size:100})})}),Object(a.jsx)(z.a,{xs:12,className:"mt-4",children:Object(a.jsx)(o.b,{to:"/chat/4",children:Object(a.jsx)(qe.a,{color:"white",size:100})})})]})]})]}):Object(a.jsx)(I.a,{to:de.LOGIN})},rt=Object(i.b)((function(e){return{currentUserState:q(e)}}),(function(e){return{getChats:function(){return e(Ne())},updateUserLocation:function(t){return e(ie(t))}}}))(at),ct=n(64),st=n(97),ot=n.n(st),it=(n(179),n(62)),lt=n.n(it),ut=function(e){var t=e.message,n=t.text,r=t.user,c=!1,s=e.name.trim().toLowerCase();return r===s&&(c=!0),c?Object(a.jsxs)("div",{className:"messageContainer justifyEnd",children:[Object(a.jsx)("p",{className:"sentText pr-10",children:s}),Object(a.jsx)("div",{className:"messageBox backgroundBlue",children:Object(a.jsx)("p",{className:"messageText colorWhite",children:lt.a.emojify(n)})})]}):Object(a.jsxs)("div",{className:"messageContainer justifyStart",children:[Object(a.jsx)("div",{className:"messageBox backgroundLight",children:Object(a.jsx)("p",{className:"messageText colorDark",children:lt.a.emojify(n)})}),Object(a.jsx)("p",{className:"sentText pl-10 ",children:r})]})},jt=(n(180),function(e){var t=e.messages,n=e.name;return Object(a.jsx)(ot.a,{className:"messages",children:t.map((function(e,t){return Object(a.jsx)("div",{children:Object(a.jsx)(ut,{message:e,name:n})},t)}))})}),Ot=(n(181),function(e){var t=e.room;return Object(a.jsx)("div",{className:"infoBar",children:Object(a.jsxs)("div",{className:"leftInnerContainer",children:[Object(a.jsx)("img",{className:"onlineIcon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAAAXNSR0IArs4c6QAAAExJREFUCB1jbPh/le3lx5tNDIwMcQwg8J9hkTi/eh0LWJCBoRwoAAPlQDEGJrhKmDCIBupmQuYjs5lAZiILgNlAMRaQRSAz4UZCLQcAIwYaiAejKoYAAAAASUVORK5CYII=",alt:"online icon"}),Object(a.jsxs)("h3",{children:["Room ",t]})]})})}),dt=(n(182),function(e){var t=e.setMessage,n=e.sendMessage,r=e.message;return Object(a.jsxs)("form",{className:"form",children:[Object(a.jsx)("input",{className:"input",type:"text",placeholder:"Type a message...",value:r,onChange:function(e){var n=e.target.value;return t(n)},onKeyPress:function(e){return"Enter"===e.key?n(e):null}}),Object(a.jsx)("button",{className:"sendButton",onClick:function(e){return n(e)},children:"Send"})]})});n(183);var bt=function(e){var t=e.currentUserState,n=(t=void 0===t?{}:t).isAuthenticated,c=t.currentUser,s=e.appSocket,o=Object(I.i)().room,i=c,l=Object(r.useState)(!1),u=Object(k.a)(l,2),j=u[0],O=u[1],d=Object(r.useState)(""),b=Object(k.a)(d,2),h=b[0],p=b[1],x=Object(r.useState)([]),m=Object(k.a)(x,2),f=m[0],E=m[1];return Object(r.useEffect)((function(){return s.on("message",(function(e){console.log(e),E((function(t){return[].concat(Object(ct.a)(t),[e])}))})),function(){s.emit("leaveChat",{user:i,room:o}),s.off()}}),[]),n?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Pe,{title:"Chat Room",back:de.ROOMS}),Object(a.jsx)("div",{className:"outerContainer",children:Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)(Ot,{room:""}),j?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(jt,{messages:f,name:i.name}),Object(a.jsx)(dt,{message:h,setMessage:p,sendMessage:function(e){e.preventDefault(),h&&(E((function(e){return[].concat(Object(ct.a)(e),[{user:"You",text:h}])})),s.emit("sendMessage",{user:i,room:o,message:h},(function(){return p("")})))}})]}):Object(a.jsx)("div",{className:"btn btn-primary mb-4",onClick:function(){s.emit("join",{user:i,room:o},(function(e){e&&alert(e),O(!0)}))},children:"Join chat"})]})})]}):Object(a.jsx)(I.a,{to:de.LOGIN})},ht=Object(i.b)((function(e){return{currentUserState:q(e)}}),(function(e){return{getChats:function(){return e(Ne())}}}))(bt);n(184);var pt=function(e){var t=e.msg,n=e.room,c=Object(I.g)(),s=Object(r.useState)(!1),o=Object(k.a)(s,2),i=o[0],l=o[1];return Object(a.jsx)(H.a,{children:Object(a.jsx)(Q.a,{children:Object(a.jsx)(z.a,{xs:12,className:"notification bg-secondary fade-in ".concat(i&&"fade-out"),onClick:function(){c.push(de.CHAT+n),l(!0)},children:t})})})};var xt=function(){var e=Object(i.c)((function(e){return e})).user,t=Object(r.useState)(null),n=Object(k.a)(t,2),c=n[0],s=n[1],o=e.currentUser.token?w()(X,{withCredentials:!0,query:"token=".concat(e.currentUser.token)}):null;return o&&o.on("newMessage",function(){var e=Object(P.a)(A.a.mark((function e(t){var n,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.sender,a=t.room,s({msg:"New chat request from ".concat(n,"!"),room:a}),setTimeout((function(){return s(null)}),1e4);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(I.d,{children:[Object(a.jsx)(I.b,{path:de.HOME,exact:!0,children:Object(a.jsx)(W,{})}),Object(a.jsx)(I.b,{path:de.LOGIN,children:Object(a.jsx)(he,{})}),Object(a.jsx)(I.b,{path:de.DASHBOARD,children:Object(a.jsx)(Ye,{})}),Object(a.jsx)(I.b,{path:de.PROFILE+":id",children:Object(a.jsx)(nt,{})}),Object(a.jsx)(I.b,{path:de.MAP,children:Object(a.jsx)(Ke,{appSocket:o})}),Object(a.jsx)(I.b,{path:de.REGISTER,children:Object(a.jsx)(fe,{})}),Object(a.jsx)(I.b,{path:de.ROOMS,children:Object(a.jsx)(rt,{})}),Object(a.jsx)(I.b,{path:de.CHAT+":room",children:Object(a.jsx)(ht,{appSocket:o})})]}),c&&Object(a.jsx)(pt,{msg:c.msg,room:c.room})]})};s.a.render(Object(a.jsx)(o.a,{children:Object(a.jsx)(i.a,{store:_,children:Object(a.jsx)(l.a,{loading:null,persistor:T,children:Object(a.jsx)(xt,{})})})}),document.getElementById("root"))}},[[185,1,2]]]);
//# sourceMappingURL=main.6bb7e63f.chunk.js.map